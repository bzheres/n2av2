<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>N2A – Maintenance</title>

    <!-- Use your existing favicon / logo from /public -->
    <link rel="icon" href="/favicon.ico" />
    <!-- If your logo is a different filename (e.g. /logo.png), update below too -->

    <style>
      :root{
        --bg:#0E1420;
        --card:rgba(255,255,255,0.06);
        --card2:rgba(255,255,255,0.04);
        --text:#F7F7F8;
        --muted:rgba(247,247,248,0.75);
        --border:rgba(255,255,255,0.12);
        --accent:#D56DB5;
        --accent2:#206AA9;
      }
      *{box-sizing:border-box}
      body{
        margin:0;
        min-height:100vh;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
        background:
          radial-gradient(900px 600px at 20% 10%, rgba(213,109,181,0.22), transparent 55%),
          radial-gradient(900px 600px at 85% 80%, rgba(32,106,169,0.22), transparent 55%),
          var(--bg);
        color:var(--text);
        display:flex;
        align-items:center;
        justify-content:center;
        padding:28px;
      }
      .wrap{max-width:980px;width:100%}
      .card{
        background:linear-gradient(180deg, var(--card), var(--card2));
        border:1px solid var(--border);
        border-radius:22px;
        padding:28px;
        box-shadow: 0 10px 35px rgba(0,0,0,0.45);
        backdrop-filter: blur(10px);
      }
      .top{
        display:flex;
        gap:18px;
        align-items:center;
        justify-content:space-between;
        flex-wrap:wrap;
      }
      .brand{
        display:flex;
        gap:14px;
        align-items:center;
      }
      .logo{
        width:54px;height:54px;
        border-radius:14px;
        border:1px solid var(--border);
        background:rgba(255,255,255,0.06);
        display:flex;
        align-items:center;
        justify-content:center;
        overflow:hidden;
      }
      .logo img{width:100%;height:100%;object-fit:contain;padding:10px}
      h1{margin:0;font-size:28px;letter-spacing:0.2px}
      .pill{
        display:inline-flex;
        align-items:center;
        gap:8px;
        border:1px solid var(--border);
        border-radius:999px;
        padding:8px 12px;
        color:var(--muted);
        font-size:13px;
      }
      .grid{
        margin-top:18px;
        display:grid;
        grid-template-columns: 1.2fr 0.8fr;
        gap:16px;
      }
      @media (max-width:860px){
        .grid{grid-template-columns:1fr}
      }
      .box{
        border:1px solid var(--border);
        border-radius:18px;
        padding:18px;
        background:rgba(0,0,0,0.18);
      }
      .box h2{margin:0 0 10px 0;font-size:16px;color:var(--text)}
      .box p{margin:0;color:var(--muted);line-height:1.5}
      .list{margin:10px 0 0 0;padding-left:18px;color:var(--muted);line-height:1.55}
      .actions{
        margin-top:14px;
        display:flex;
        gap:10px;
        flex-wrap:wrap;
      }
      .btn{
        cursor:pointer;
        border:1px solid var(--border);
        background:rgba(255,255,255,0.06);
        color:var(--text);
        padding:10px 14px;
        border-radius:14px;
        font-weight:600;
        font-size:14px;
        text-decoration:none;
        display:inline-flex;
        align-items:center;
        gap:8px;
      }
      .btn:hover{border-color:rgba(255,255,255,0.25)}
      .btn.primary{
        border-color:rgba(213,109,181,0.5);
        background:rgba(213,109,181,0.14);
      }
      .btn.primary:hover{
        border-color:rgba(213,109,181,0.8);
        background:rgba(213,109,181,0.18);
      }
      .small{
        margin-top:14px;
        font-size:13px;
        color:rgba(247,247,248,0.62);
      }
      .admin{
        margin-top:8px;
        display:none;
      }
      .admin.show{display:block}
      .row{
        display:flex;
        gap:10px;
        flex-wrap:wrap;
        margin-top:10px;
      }
      input{
        flex:1;
        min-width:220px;
        padding:10px 12px;
        border-radius:12px;
        border:1px solid var(--border);
        background:rgba(255,255,255,0.06);
        color:var(--text);
        outline:none;
      }
      .hint{font-size:12px;color:rgba(247,247,248,0.55);margin-top:8px}
      .status{
        margin-top:10px;
        font-size:13px;
        color:rgba(247,247,248,0.72);
      }
      code{color:#fff;background:rgba(255,255,255,0.08);padding:2px 6px;border-radius:8px}
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="card">
        <div class="top">
          <div class="brand">
            <div class="logo">
              <!-- Change /favicon.ico to your logo file if needed (e.g. /N2A_temp_logo.png) -->
              <img src="/favicon.ico" alt="N2A" />
            </div>
            <div>
              <h1>N2A is in maintenance mode</h1>
              <div class="pill">We’re fixing AI formatting → Anki export compatibility</div>
            </div>
          </div>

          <a class="btn" href="mailto:admin@n2a.com.au">Contact</a>
        </div>

        <div class="grid">
          <div class="box">
            <h2>What’s happening</h2>
            <p>
              We’re improving how cards export to Anki so formatting (line breaks, bullets, MCQs) imports correctly every time.
              The app is temporarily restricted while we finish validation.
            </p>

            <ul class="list">
              <li>AI formatting review improvements</li>
              <li>Stable HTML/CSV export for Anki</li>
              <li>End-to-end stress testing</li>
            </ul>

            <div class="actions">
              <button class="btn primary" id="toggleAdmin">Admin access</button>
              <a class="btn" href="/" onclick="return false;">App is currently restricted</a>
            </div>

            <div class="small">
              If you’re an existing user: thanks for your patience — we’re making exports much cleaner.
            </div>
          </div>

          <div class="box">
            <h2>Status</h2>
            <p>
              Maintenance is active. Public access is paused while fixes are applied and verified.
            </p>
            <div class="status" id="statusText">Public: blocked · Admin: available with access key</div>

            <div class="admin" id="adminPanel">
              <div class="hint">
                Admin-only: enter your access key to open the app. (This does not use Netlify Identity.)
              </div>
              <div class="row">
                <input id="accessKey" type="password" placeholder="Enter admin access key" />
                <button class="btn primary" id="enterBtn">Enter</button>
              </div>
              <div class="hint">
                You’ll be redirected to <code>/app</code> with a temporary token.
              </div>
              <div class="status" id="adminMsg"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const toggleBtn = document.getElementById("toggleAdmin");
      const adminPanel = document.getElementById("adminPanel");
      const enterBtn = document.getElementById("enterBtn");
      const accessKey = document.getElementById("accessKey");
      const adminMsg = document.getElementById("adminMsg");

      toggleBtn.addEventListener("click", () => {
        adminPanel.classList.toggle("show");
        accessKey.focus();
      });

      // This is ONLY UI. The real protection is done via Netlify redirects (next section).
      // We'll send the user to /app with a query param token.
      // Netlify will only allow /app if the token matches (via an environment variable check).
      enterBtn.addEventListener("click", () => {
        const key = (accessKey.value || "").trim();
        if (!key) {
          adminMsg.textContent = "Enter the access key.";
          return;
        }
        adminMsg.textContent = "Checking...";
        const url = "/app?key=" + encodeURIComponent(key);
        window.location.href = url;
      });

      accessKey.addEventListener("keydown", (e) => {
        if (e.key === "Enter") enterBtn.click();
      });
    </script>
  </body>
</html>
